PS E:\diabetic-retinopathy-ai> python ./main.py
Epoch 1/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [09:34<00:00,  5.35it/s]
Train Loss: 1.0566, Accuracy: 0.5197
Validation Loss: 0.9533, Accuracy: 0.5716
✅ Model zapisany!
Epoch 2/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [09:00<00:00,  5.68it/s]
Train Loss: 0.6922, Accuracy: 0.6320
Validation Loss: 0.9081, Accuracy: 0.6348
✅ Model zapisany!
Epoch 3/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.4526, Accuracy: 0.7324
Validation Loss: 0.9948, Accuracy: 0.6481
✅ Model zapisany!
Epoch 4/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.3110, Accuracy: 0.8128
Validation Loss: 1.0231, Accuracy: 0.6944
✅ Model zapisany!
Epoch 5/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.2351, Accuracy: 0.8579
Validation Loss: 1.1464, Accuracy: 0.6788
Epoch 6/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.1737, Accuracy: 0.8942
Validation Loss: 1.2461, Accuracy: 0.7046
✅ Model zapisany!
Epoch 7/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.1509, Accuracy: 0.9108
Validation Loss: 1.3398, Accuracy: 0.7056
✅ Model zapisany!
Epoch 8/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s] 
Train Loss: 0.1356, Accuracy: 0.9231
Validation Loss: 1.3528, Accuracy: 0.7293
✅ Model zapisany!
Epoch 9/70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.1098, Accuracy: 0.9378
Validation Loss: 1.4399, Accuracy: 0.7166
Epoch 10/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.1030, Accuracy: 0.9413
Validation Loss: 1.4594, Accuracy: 0.7422
✅ Model zapisany!
Epoch 11/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s] 
Train Loss: 0.0950, Accuracy: 0.9482
Validation Loss: 1.5749, Accuracy: 0.7382
Epoch 12/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0844, Accuracy: 0.9528
Validation Loss: 1.6003, Accuracy: 0.7453
✅ Model zapisany!
Epoch 13/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0845, Accuracy: 0.9545
Validation Loss: 1.5612, Accuracy: 0.7263
Epoch 14/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0722, Accuracy: 0.9594
Validation Loss: 1.6945, Accuracy: 0.7498
✅ Model zapisany!
Epoch 15/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0644, Accuracy: 0.9649
Validation Loss: 1.7375, Accuracy: 0.7289
Epoch 16/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0736, Accuracy: 0.9615
Validation Loss: 1.6421, Accuracy: 0.7519
✅ Model zapisany!
Epoch 17/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0560, Accuracy: 0.9689
Validation Loss: 1.7814, Accuracy: 0.7492
Epoch 18/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0579, Accuracy: 0.9688
Validation Loss: 1.8493, Accuracy: 0.7574
✅ Model zapisany!
Epoch 19/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s] 
Train Loss: 0.0567, Accuracy: 0.9694
Validation Loss: 1.7884, Accuracy: 0.7293
Epoch 20/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0522, Accuracy: 0.9713
Validation Loss: 1.7700, Accuracy: 0.7342
Epoch 21/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.72it/s]
Train Loss: 0.0523, Accuracy: 0.9729
Validation Loss: 1.8343, Accuracy: 0.7426
Epoch 22/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.0477, Accuracy: 0.9753
Validation Loss: 1.8186, Accuracy: 0.7464
Epoch 23/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0467, Accuracy: 0.9750
Validation Loss: 1.8530, Accuracy: 0.7454
Epoch 24/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0500, Accuracy: 0.9739
Validation Loss: 1.9436, Accuracy: 0.7597
✅ Model zapisany!
Epoch 25/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0479, Accuracy: 0.9760
Validation Loss: 1.9626, Accuracy: 0.7544
Epoch 26/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0436, Accuracy: 0.9775
Validation Loss: 2.0408, Accuracy: 0.7621
✅ Model zapisany!
Epoch 27/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0392, Accuracy: 0.9791
Validation Loss: 1.9938, Accuracy: 0.7354
Epoch 28/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.0420, Accuracy: 0.9776
Validation Loss: 2.0370, Accuracy: 0.7504
Epoch 29/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0407, Accuracy: 0.9791
Validation Loss: 2.0942, Accuracy: 0.7358
Epoch 30/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0402, Accuracy: 0.9790
Validation Loss: 1.9615, Accuracy: 0.7460
Epoch 31/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0387, Accuracy: 0.9810
Validation Loss: 1.8758, Accuracy: 0.7322
Epoch 32/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0335, Accuracy: 0.9813
Validation Loss: 2.1525, Accuracy: 0.7540
Epoch 33/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0373, Accuracy: 0.9800
Validation Loss: 2.0942, Accuracy: 0.7637
✅ Model zapisany!
Epoch 34/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0374, Accuracy: 0.9810
Validation Loss: 2.1132, Accuracy: 0.7301
Epoch 35/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.0320, Accuracy: 0.9826
Validation Loss: 2.0819, Accuracy: 0.7339
Epoch 36/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0334, Accuracy: 0.9829
Validation Loss: 2.0997, Accuracy: 0.7587
Epoch 37/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.0286, Accuracy: 0.9840
Validation Loss: 2.2344, Accuracy: 0.7521
Epoch 38/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.0339, Accuracy: 0.9835
Validation Loss: 2.1760, Accuracy: 0.7629
Epoch 39/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:59<00:00,  5.70it/s]
Train Loss: 0.0354, Accuracy: 0.9832
Validation Loss: 2.0394, Accuracy: 0.7618
Epoch 40/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0270, Accuracy: 0.9859
Validation Loss: 2.1027, Accuracy: 0.7754
✅ Model zapisany!
Epoch 41/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0299, Accuracy: 0.9841
Validation Loss: 2.1962, Accuracy: 0.7530
Epoch 42/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0261, Accuracy: 0.9863
Validation Loss: 2.2200, Accuracy: 0.7323
Epoch 43/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.0310, Accuracy: 0.9841
Validation Loss: 2.2255, Accuracy: 0.7491
Epoch 44/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0276, Accuracy: 0.9866
Validation Loss: 2.1403, Accuracy: 0.7509
Epoch 45/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0263, Accuracy: 0.9867
Validation Loss: 2.1401, Accuracy: 0.7348
Epoch 46/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0297, Accuracy: 0.9856
Validation Loss: 2.3312, Accuracy: 0.7658
Epoch 47/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.71it/s]
Train Loss: 0.0248, Accuracy: 0.9872
Validation Loss: 2.2691, Accuracy: 0.7591
Epoch 48/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0227, Accuracy: 0.9870
Validation Loss: 2.3582, Accuracy: 0.7462
Epoch 49/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0280, Accuracy: 0.9866
Validation Loss: 2.3694, Accuracy: 0.7557
Epoch 50/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0254, Accuracy: 0.9877
Validation Loss: 2.3906, Accuracy: 0.7519
Epoch 51/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0275, Accuracy: 0.9866
Validation Loss: 2.2722, Accuracy: 0.7565
Epoch 52/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0217, Accuracy: 0.9881
Validation Loss: 2.4337, Accuracy: 0.7500
Epoch 53/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0255, Accuracy: 0.9871
Validation Loss: 2.4120, Accuracy: 0.7473
Epoch 54/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0212, Accuracy: 0.9885
Validation Loss: 2.4137, Accuracy: 0.7483
Epoch 55/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:57<00:00,  5.72it/s]
Train Loss: 0.0256, Accuracy: 0.9865
Validation Loss: 2.2825, Accuracy: 0.7472
Epoch 56/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0280, Accuracy: 0.9864
Validation Loss: 2.3630, Accuracy: 0.7608
Epoch 57/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0220, Accuracy: 0.9886
Validation Loss: 2.3050, Accuracy: 0.7652
Epoch 58/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0262, Accuracy: 0.9877
Validation Loss: 2.4747, Accuracy: 0.7686
Epoch 59/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0214, Accuracy: 0.9901
Validation Loss: 2.4434, Accuracy: 0.7559
Epoch 60/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0221, Accuracy: 0.9889
Validation Loss: 2.3530, Accuracy: 0.7686
Epoch 61/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0185, Accuracy: 0.9895
Validation Loss: 2.4848, Accuracy: 0.7646
Epoch 62/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0238, Accuracy: 0.9874
Validation Loss: 2.4314, Accuracy: 0.7627
Epoch 63/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0209, Accuracy: 0.9892
Validation Loss: 2.2337, Accuracy: 0.7168
Epoch 64/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0222, Accuracy: 0.9885
Validation Loss: 2.1355, Accuracy: 0.7386
Epoch 65/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0193, Accuracy: 0.9895
Validation Loss: 2.2312, Accuracy: 0.7578
Epoch 66/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [08:58<00:00,  5.71it/s]
Train Loss: 0.0164, Accuracy: 0.9910
Validation Loss: 2.5024, Accuracy: 0.7397
Epoch 67/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [09:14<00:00,  5.54it/s]
Train Loss: 0.0215, Accuracy: 0.9896
Validation Loss: 2.4046, Accuracy: 0.7475
Epoch 68/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [09:08<00:00,  5.60it/s]
Train Loss: 0.0230, Accuracy: 0.9891
Validation Loss: 2.5100, Accuracy: 0.7690
Epoch 69/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [09:09<00:00,  5.59it/s]
Train Loss: 0.0220, Accuracy: 0.9893
Validation Loss: 2.4153, Accuracy: 0.7658
Epoch 70/70: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3074/3074 [09:08<00:00,  5.61it/s]
Train Loss: 0.0177, Accuracy: 0.9908
Validation Loss: 2.4219, Accuracy: 0.7517

🔍 Accuracy: 0.4766
Level 0 → Precision: 0.84, Recall: 0.93, F1: 0.88
Level 1 → Precision: 0.14, Recall: 0.06, F1: 0.08
Level 2 → Precision: 0.57, Recall: 0.45, F1: 0.51
Level 3 → Precision: 0.52, Recall: 0.39, F1: 0.44
Level 4 → Precision: 0.62, Recall: 0.55, F1: 0.58